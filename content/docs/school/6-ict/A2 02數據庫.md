---
title: "A2 數據庫"
weight: 5
---

## 數據庫結構

$$ \text{數據庫} $$  
$$ \downarrow $$  
$$ \text{數據表} $$  
$$ \downarrow $$  
$$ \text{行與列} $$  
$$ \downarrow $$  
$$ \text{欄位} $$

### 數據類型

- 文字
- 數字
- 日期
- 貨幣
- 自動編號
- 布爾值

## SQL 指令

### 1. 常數 (Constants)

用於邏輯判斷的布林值：

- TRUE：真（邏輯正確）
- FALSE：假（邏輯錯誤）

### 2. 運算符 (Operators)

這些符號用於數學計算、比較和邏輯組合：

- 算術運算：`+` (加)、`-` (減)、`*` (乘)、`/` (除)
- 比較運算：
  - `>` (大於)、`<` (小於)、`=` (等於)
  - `>=` (大於或等於)、`<=` (小於或等於)
  - `<>` (不等於)
- 萬用字元與符號：
  - `%`：匹配任意數量的字元（常用於 `LIKE`）
  - `_`：匹配單個字元（常用於 `LIKE`）
  - `'`：單引號，用於標註字串常數
- 邏輯運算：
  - `AND`：且（兩者皆須成立）
  - `OR`：或（其中之一成立即可）
  - `NOT`：非（反轉邏輯狀態）

### 3. SQL 關鍵字與函數 (SQL Keywords & Functions)

用於構建查詢語句的核心指令：

- 聚合函數 (Aggregate Functions)：
  - `AVG`：計算平均值
  - `MAX`：找出最大值
  - `MIN`：找出最小值
  - `SUM`：計算總和
  - `COUNT`：計算特定紀錄的數量
- 數學函數
  - `INT()`：將數字向下捨入至最近的整數。
  - `ABS()`：傳回數字的絕對值。
  - `LEN() / CHAR_LENGTH()`：傳回字串的字符數。
  - `MID() / SUBSTRING() / SUBSTR()`：從字串中間的一個特定位置，傳回一連串字符數。
  - `LOWER()`：將字串轉為小寫字母。
  - `UPPER()`：將字串轉為大寫字母。
  - `TRIM()`：移除字串頭和尾的空格。
  - `SPACE()`：傳回一個由若干空格組成的字串。
- 查詢基礎：
  - `SELECT`：選取欄位
  - `FROM`：指定資料表
  - `WHERE`：設定篩選條件
  - `DISTINCT`：去除重複的資料
  - `AS`：重新命名欄位或資料表（別名）
- 條件與搜尋：
  - `BETWEEN`：在特定的範圍之內
  - `LIKE`：模式搜尋（模糊匹配）
  - `NULL`：空值（代表沒有資料）
  - `IN`：指定多於一個值("`...`", "`...`")
- 排序與分組：
  - `ORDER BY`：對結果進行排序
  - `ASC`：升序排列（由小到大）
  - `DESC`：降序排列（由大到小）
  - `GROUP BY`：依照欄位進行分組
  - `HAVING`：分組後的篩選條件（配合 `GROUP BY` 使用）

---

| 順序  | 指令         | 用途說明                                 |
| :---- | :----------- | :--------------------------------------- |
| **1** | **SELECT**   | 我要看什麼？                             |
| **2** | **FROM**     | 從哪裡找？                               |
| **3** | **WHERE**    | 哪些資料符合條件？（過濾每一列）         |
| **4** | **GROUP BY** | 怎麼分類？（例如按部門、按日期）         |
| **5** | **HAVING**   | 分類完後，哪些組要留下來？（過濾組別）   |
| **6** | **ORDER BY** | 最後要怎麼排順序？（由大到小或由小到大） |

**快速語法範例：**

```sql
SELECT AVG(薪資) AS 平均薪資
FROM 員工表
WHERE 部門 = '業務部'
GROUP BY 職位
HAVING COUNT(*) > 5
ORDER BY 平均薪資 DESC;
```
